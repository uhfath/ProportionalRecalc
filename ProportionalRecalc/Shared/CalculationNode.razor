@inherits ComponentBase

<div class="row">
	<div class="col-auto">
		<table class="table table-striped table-hover table-sm w-auto shadow rounded bg-body">
			<thead class="table-light">
				<tr>
					<th scope="col" colspan="2" class="align-bottom">
						<button class="btn btn-sm btn-danger w-100" @onclick="OnCalculationDelete" title="Удалить расчёт">Удалить</button>
					</th>
					<th scope="col" class="align-top">
						<div class="d-flex align-items-baseline">
							<span>Исходные данные</span>
							<button type="button" class="btn btn-link btn-sm" title="Вставить значения из буфера обмена"><i class="bi bi-clipboard-data"></i></button>
						</div>
						<InputDecimal IsReadOnly="true" placeholder="Исходная сумма..." Value="Calculation.SourceSum" />
					</th>

					<th scope="col" class="align-bottom">
						<button type="button" @onclick="OnColumnAdd" class="btn btn-outline-secondary btn-sm" title="Добавить новый столбец"><i class="bi bi-plus-lg"></i></button>
					</th>
				</tr>
			</thead>
			<tbody>
				@for (var i = 0; i < Calculation.Source.Count; i++)
				{
					var currentIndex = i;
					<tr>
						<td scope="row" class="align-middle">
							<button class="cell-hover btn btn-sm btn-link link-success" @onclick="() => OnRowInsert.InvokeAsync(currentIndex)" title="Добавить строку" tabindex="-1"><i class="bi bi-plus-lg"></i></button>

							@if (Calculation.Source.Count > 1)
							{
								<button class="cell-hover btn btn-sm btn-link link-danger" @onclick="() => OnRowRemove.InvokeAsync(currentIndex)" title="Удалить строку" tabindex="-1"><i class="bi bi-trash-fill"></i></button>
							}
						</td>
						<td scope="row" class="align-middle">@(i + 1)</td>
						<td scope="row" class="align-middle">
							<InputDecimal
										  Value="Calculation.Source[i]"
										  OnChanged="e => OnCellChanged(currentIndex, e)"
										  OnRowInsertShortcut="() => OnRowInsert.InvokeAsync(currentIndex)"
										  placeholder="Исходное значение..." />
						</td>

						<td></td>
					</tr>
				}
			</tbody>
		</table>
	</div>
</div>
